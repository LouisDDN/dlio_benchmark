"""
 Copyright (C) 2020  Argonne, Hariharan Devarajan <hdevarajan@anl.gov>
 This file is part of DLProfile
 DLIO is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as
 published by the Free Software Foundation, either version 3 of the published by the Free Software Foundation, either
 version 3 of the License, or (at your option) any later version.
 This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied
 warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more
 details.
 You should have received a copy of the GNU General Public License along with this program.
 If not, see <http://www.gnu.org/licenses/>.
"""

import os
from datetime import datetime

from src.utils.argument_parser import ArgumentParser

# UTC timestamp format with microsecond precision
LOG_TS_FORMAT = "%Y-%m-%dT%H:%M:%S.%f"

# Where does this print?? I don't see it in the terminal
def progress(count, total, status=''):
    _arg_parser = ArgumentParser.get_instance()
    bar_len = 60
    filled_len = int(round(bar_len * count / float(total)))
    percents = round(100.0 * count / float(total), 1)
    bar = '=' * filled_len + '-' * (bar_len - filled_len)
    if _arg_parser.args.debug:
        if count == 1:
            print("")
        print("\r[{}] {}% {} of {} {} ".format(bar, percents, count, total, status), end='')
        if count == total:
            print("")
        os.sys.stdout.flush()

def utcnow(format=LOG_TS_FORMAT):
    return datetime.utcnow().strftime(format)